/* eslint-disable no-console */

import Logger from "."

global.console.trace = jest.fn()
const mockedConsole = console.trace as jest.Mock<typeof console.trace>

describe("logger works correctly", () => {
  it("copies module stack on Logger.module", () => {
    const empty = new Logger()
    expect(empty.moduleStack).toEqual([])

    const aModule = empty.module("a")
    expect(aModule.moduleStack).toEqual(["a"])

    const bModule = aModule.module("b")
    expect(bModule.moduleStack).toEqual(["a", "b"])
  })

  it("calls console.log", () => {
    const logger = new Logger()

    logger.trace("message", {ctx: true})
    expect(mockedConsole.mock.calls[0]).toEqual(["message", {ctx: true}])
  })
})
